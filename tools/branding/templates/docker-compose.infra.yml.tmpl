# Auto-generated by branding generator. Do not edit directly.
# Source: tools/branding/templates/docker-compose.infra.yml.tmpl

services:
  # ============================================
  # Shared Container Registry (Host Port 5010)
  # ============================================
  registry:
    image: registry:2
    container_name: ${REGISTRY_CONTAINER_NAME:-{{SLUG}}-infra-registry}
    stop_grace_period: 3s
    ports:
      - "${PORT_REGISTRY:-5010}:5010"
    volumes:
      - registry_data:/var/lib/registry
    environment:
      REGISTRY_HTTP_ADDR: 0.0.0.0:5010
      # Enable delete image support for cleanups
      REGISTRY_STORAGE_DELETE_ENABLED: "true"
    healthcheck:
      test: ["CMD", "wget", "-q", "-Y", "off", "--spider", "http://127.0.0.1:5010/v2/"]
      interval: 10s
      timeout: 5s
      retries: 5
    restart: always
    networks:
      external_network:
        aliases:
          - registry

volumes:
  registry_data:

networks:
  external_network:
    name: ${NETWORK_EXTERNAL:-${PROJECT_NAME:-{{SLUG}}-${ENV:-default}}-external}
    driver: bridge
