# Auto-generated by branding generator. Do not edit directly.
# Source: tools/branding/templates/docker-compose.worker.yml.tmpl
services:
  agent:
    image: {{IMAGE_PREFIX}}-agent:{{ENV_PREFIX_VAR}}_IMAGE_TAG:-latest}
    build:
      context: services/agent
      dockerfile: Dockerfile
      args:
        OS_BASE_IMAGE: {{IMAGE_PREFIX}}-os-base:latest
    container_name: {{ENV_PREFIX_VAR}}_PROJECT_NAME:-{{SLUG}}}-agent
    cap_add: [NET_ADMIN, SYS_ADMIN]
    environment:
      - LOG_LEVEL=${LOG_LEVEL:-INFO}
      - PORT=50051
      - CONTAINER_REGISTRY=${CONTAINER_REGISTRY:-}
      - CNI_SUBNET=${CNI_SUBNET:-}
      # Default: Overridden by Adapter
      - AGENT_RUNTIME=${AGENT_RUNTIME:-containerd} 
      - CONTAINERS_NETWORK={{ENV_PREFIX_VAR}}_NETWORK_EXTERNAL:-test-external}
      - HTTP_PROXY
      - HTTPS_PROXY
      - NO_PROXY
      - http_proxy
      - https_proxy
      - no_proxy
    volumes:
      - {{ENV_PREFIX_VAR}}_CERT_DIR:-~/{{HOME_DIR}}/certs}:/app/config/ssl:ro
    command: ["/app/agent"]
    restart: unless-stopped
